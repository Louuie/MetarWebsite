{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Elias\\\\Documents\\\\Programming\\\\MetarWebsite\\\\frontend\\\\src\\\\App.tsx\",\n    _s = $RefreshSig$();\n\nimport Home from './components/Home/Home.tsx';\nimport Metar from './components/Airport/Metar.tsx';\nimport Login from './components/Login/Login.tsx';\nimport User from './components/User/User.tsx';\nimport { firebaseAuth } from './firebase';\nimport { Suspense, useEffect, useState } from 'react';\nimport { Routes, Route, NavLink } from 'react-router-dom';\nimport './App.css';\nimport Airport from './components/Airport/Airport.tsx';\nimport { onAuthStateChanged } from 'firebase/auth';\nimport \"./spinner.css\";\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction App() {\n  _s();\n\n  let [auth, setAuth] = useState(false || window.localStorage.getItem('auth') === 'true');\n  let [token, setToken] = useState(null);\n  let unmounted = false;\n  useEffect(() => {\n    onAuthStateChanged(firebaseAuth, user => {\n      if (!unmounted && user) {\n        user.getIdToken().then(token => setToken(token));\n        isValidToken();\n      } else setAuth(false);\n    });\n    return () => {\n      unmounted = true;\n    };\n  });\n\n  const isValidToken = () => {\n    axios.get('http://localhost:4000/auth/status', {\n      headers: {\n        Authorization: 'Bearer ' + token\n      }\n    }).then(response => {\n      if (!unmounted) {\n        if (response.data.error == undefined || response.data.error == null && response.data.isAuthenticated == true) {\n          setAuth(true);\n          window.localStorage.setItem('auth', 'true');\n        } else setAuth(false);\n      }\n    }).catch(err => console.log(err));\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(Suspense, {\n      children: auth ? /*#__PURE__*/_jsxDEV(Routes, {\n        children: [/*#__PURE__*/_jsxDEV(Route, {\n          path: \"/\",\n          element: /*#__PURE__*/_jsxDEV(Home, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 49,\n            columnNumber: 42\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 49,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/user\",\n          element: /*#__PURE__*/_jsxDEV(User, {\n            token: token\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 50,\n            columnNumber: 46\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 50,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/metar/:airport\",\n          element: /*#__PURE__*/_jsxDEV(Metar, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 51,\n            columnNumber: 56\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 51,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/:airport\",\n          element: /*#__PURE__*/_jsxDEV(Airport, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 52,\n            columnNumber: 50\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 52,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 15\n      }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: /*#__PURE__*/_jsxDEV(NavLink, {\n          to: \"/login\",\n          children: /*#__PURE__*/_jsxDEV(Login, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 56,\n            columnNumber: 42\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 56,\n          columnNumber: 11\n        }, this)\n      }, void 0, false)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 5\n    }, this)\n  }, void 0, false);\n}\n\n_s(App, \"EflbY1PYLe4CmnMmvSsmrr558xs=\");\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"sources":["C:/Users/Elias/Documents/Programming/MetarWebsite/frontend/src/App.tsx"],"names":["Home","Metar","Login","User","firebaseAuth","Suspense","useEffect","useState","Routes","Route","NavLink","Airport","onAuthStateChanged","axios","App","auth","setAuth","window","localStorage","getItem","token","setToken","unmounted","user","getIdToken","then","isValidToken","get","headers","Authorization","response","data","error","undefined","isAuthenticated","setItem","catch","err","console","log"],"mappings":"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","sourcesContent":["import Home from './components/Home/Home.tsx';\r\nimport Metar from './components/Airport/Metar.tsx'\r\nimport Login from './components/Login/Login.tsx'\r\nimport User from './components/User/User.tsx';\r\nimport {firebaseAuth} from './firebase';\r\nimport { Suspense, useEffect, useState } from 'react';\r\nimport {Routes, Route, Link, NavLink } from 'react-router-dom';\r\nimport './App.css';\r\nimport Airport from './components/Airport/Airport.tsx';\r\nimport { onAuthStateChanged } from 'firebase/auth';\r\nimport \"./spinner.css\";\r\nimport axios from 'axios';\r\n\r\n\r\nfunction App() {\r\n\r\n  let [auth, setAuth] = useState(false || window.localStorage.getItem('auth') === 'true');\r\n  let [token, setToken] = useState(null);\r\n  let unmounted = false;\r\n\r\n  useEffect(() => {\r\n    onAuthStateChanged(firebaseAuth, (user) => {\r\n      if(!unmounted && user) {\r\n        user.getIdToken().then((token) => setToken(token));\r\n        isValidToken();\r\n      } else setAuth(false);\r\n    });\r\n    return () => { unmounted = true; }\r\n  });\r\n\r\n  const isValidToken = () => {\r\n    axios.get('http://localhost:4000/auth/status', {\r\n      headers: {\r\n        Authorization: 'Bearer ' + token\r\n      }\r\n    }).then((response) => {\r\n      if(!unmounted) {\r\n        if(response.data.error == undefined || response.data.error == null && response.data.isAuthenticated == true) { setAuth(true); window.localStorage.setItem('auth', 'true')} else setAuth(false);\r\n      }\r\n    }).catch((err) => console.log(err))\r\n  };\r\n\r\n\r\n  return (\r\n    <>\r\n    <Suspense>\r\n      {auth ? (\r\n              <Routes>\r\n                <Route path=\"/\" element={<Home />} />\r\n                <Route path=\"/user\" element={<User token={token} />} />\r\n                <Route path=\"/metar/:airport\" element={<Metar />} />\r\n                <Route path=\"/:airport\" element={<Airport />} />\r\n              </Routes>\r\n      ) : (\r\n        <>\r\n          <NavLink to=\"/login\" children={<Login />} />\r\n        </>\r\n      )}\r\n      </Suspense>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default App;\r\n"]},"metadata":{},"sourceType":"module"}